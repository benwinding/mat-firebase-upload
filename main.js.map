{"version":3,"sources":["webpack:///../mat-firebase-upload/src/lib/firebase/uploads-manager.ts","webpack:///../mat-firebase-upload/src/lib/form-base-class.ts","webpack:///../mat-firebase-upload/src/lib/form-controls/form-firebase-file.component.ts","webpack:///../mat-firebase-upload/src/lib/form-controls/form-firebase-files.component.ts","webpack:///../mat-firebase-upload/src/lib/form-controls/form-firebase-image.component.ts","webpack:///../mat-firebase-upload/src/lib/lib.module.ts","webpack:///../mat-firebase-upload/src/lib/subcomponents/form-file-uploader-list.component.ts","webpack:///../mat-firebase-upload/src/lib/subcomponents/form-firebase-files-viewer.component.ts","webpack:///../mat-firebase-upload/src/lib/subcomponents/preview-images/components/img-with-loader.component.ts","webpack:///../mat-firebase-upload/src/lib/subcomponents/preview-images/components/preview-gallery.component.ts","webpack:///../mat-firebase-upload/src/lib/subcomponents/preview-images/components/preview-image-popup.component.ts","webpack:///../mat-firebase-upload/src/lib/subcomponents/preview-images/components/preview-image.component.ts","webpack:///../mat-firebase-upload/src/lib/subcomponents/preview-images/lib-preview-images.module.ts","webpack:///../mat-firebase-upload/src/lib/utils/case-helper.ts","webpack:///../mat-firebase-upload/src/lib/utils/file-icon.helper.ts","webpack:///../mat-firebase-upload/src/lib/utils/img-helpers.ts","webpack:///../mat-firebase-upload/src/lib/utils/index.ts","webpack:///../mat-firebase-upload/src/lib/utils/notification.service.ts","webpack:///../mat-firebase-upload/src/lib/utils/path-helpers.ts","webpack:///../mat-firebase-upload/src/lib/utils/simple-logger.ts","webpack:///../mat-firebase-upload/src/public-api.ts","webpack:///./$_lazy_route_resource lazy namespace object","webpack:///./src/app/app.component.ts","webpack:///./src/app/app.module.ts","webpack:///./src/app/file-factory.ts","webpack:///./src/app/test-form-file.component.ts","webpack:///./src/app/test-form-files.component.ts","webpack:///./src/app/test-form-image.component.ts","webpack:///./src/app/test-form-viewers.component.ts","webpack:///./src/environments/environment.ts","webpack:///./src/main.ts"],"names":[],"mappings":"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","file":"main.js","sourcesContent":["import { timer, Subject, BehaviorSubject, Observable } from 'rxjs';\r\nimport { takeUntil, take, tap } from 'rxjs/operators';\r\nimport * as firebase from 'firebase/app';\r\nimport 'firebase/storage';\r\nimport { FormFirebaseConfigurationBase } from '../FormFirebaseFileConfiguration';\r\nimport { FormFileObject } from '../FormFileObject';\r\nimport {\r\n  NotificationService,\r\n  TrimSlashes,\r\n  blobToDataURL,\r\n  downscaleImage,\r\n  dataURItoBlob,\r\n  isFileImage,\r\n  getFileIcon\r\n} from '../utils';\r\nimport { EventEmitter } from '@angular/core';\r\nimport { v4 as uuidv4 } from 'uuid';\r\nimport { SimpleLogger } from '../utils/simple-logger';\r\n\r\nexport interface IUploadsManager {\r\n  $currentFiles: Observable<FormFileObject[]>;\r\n  onDestroy();\r\n  clickRemoveTag(fileObject: FormFileObject): Promise<void>;\r\n  onFileInputChange(event);\r\n}\r\n\r\nexport class UploadsManager implements IUploadsManager {\r\n  public $currentFiles = new BehaviorSubject<FormFileObject[]>(null);\r\n\r\n  private trackedFiles: FormFileObject[] = [];\r\n\r\n  private storage: firebase.storage.Storage;\r\n  private destroyed = new Subject();\r\n\r\n  constructor(\r\n    private config: FormFirebaseConfigurationBase,\r\n    private ns: NotificationService,\r\n    private uploadStatusChanged: EventEmitter<boolean>,\r\n    $incomingChanges: Observable<FormFileObject[]>,\r\n    initialFiles: FormFileObject[],\r\n    private logger: SimpleLogger\r\n  ) {\r\n    this.initFirebase();\r\n\r\n    this.updatesFromInternal(initialFiles, true);\r\n    // Update tracked files from form changes\r\n    $incomingChanges\r\n      .pipe(\r\n        takeUntil(this.destroyed),\r\n        tap(files => this.updatesFromExternal(files)),\r\n      )\r\n      .subscribe();\r\n  }\r\n\r\n  public onDestroy() {\r\n    this.destroyed.next();\r\n  }\r\n\r\n  private updatesFromExternal(files: FormFileObject[]) {\r\n    this.logger.log('um: updatesFromExternal', { files });\r\n    this.trackedFiles = files;\r\n  }\r\n\r\n  private updatesFromInternal(files: FormFileObject[], sendUpdate?: boolean) {\r\n    this.logger.log('um: updatesFromInternal', { files });\r\n    if (!Array.isArray(files)) {\r\n      this.trackedFiles = [];\r\n      return;\r\n    }\r\n    this.trackedFiles = files;\r\n    if (sendUpdate) {\r\n      this.$currentFiles.next(this.trackedFiles);\r\n    }\r\n  }\r\n\r\n  initFirebase() {\r\n    const app = this.getFirebaseApp(this.config);\r\n    if (!app) {\r\n      return;\r\n    }\r\n    this.storage = app.storage(this.currentBucketName());\r\n    timer(0, 1000)\r\n      .pipe(takeUntil(this.destroyed))\r\n      .subscribe(() => {\r\n        this.checkAllUploadsAreDone();\r\n      });\r\n  }\r\n\r\n  private getFirebaseApp(\r\n    config: FormFirebaseConfigurationBase\r\n  ): firebase.app.App {\r\n    if (config.firebaseApp) {\r\n      return config.firebaseApp;\r\n    }\r\n    if (!config.firebaseConfig) {\r\n      return null;\r\n    }\r\n    const firebaseConfig = this.config.firebaseConfig;\r\n    if (firebase.apps.length) {\r\n      return firebase.apps[0];\r\n    } else {\r\n      return firebase.initializeApp(firebaseConfig);\r\n    }\r\n  }\r\n\r\n  private checkAllUploadsAreDone() {\r\n    const currentFiles = this.getCurrentFiles();\r\n    const completeArray = currentFiles\r\n      .filter(f => !!f.value)\r\n      .filter(f => !!f.value.props)\r\n      .map(f => f.value.props.completed);\r\n\r\n    const haveAllFilesComplete = completeArray.reduce(\r\n      (previous, currentComplete) => previous && currentComplete,\r\n      true\r\n    );\r\n    const isStillUploading = !haveAllFilesComplete;\r\n    this.uploadStatusChanged.emit(isStillUploading);\r\n  }\r\n\r\n  private currentBucketName() {\r\n    return (\r\n      this.config.bucketname ||\r\n      // tslint:disable-next-line: no-string-literal\r\n      this.config.firebaseConfig['storageBucket']\r\n    );\r\n  }\r\n\r\n  public async clickRemoveTag(fileObject: FormFileObject) {\r\n    const currentFiles = this.getCurrentFiles();\r\n    const filteredFiles = currentFiles.filter(f => f.id !== fileObject.id);\r\n    console.log('form-files: clickRemoveTag', { currentFiles, filteredFiles });\r\n    this.updatesFromInternal(filteredFiles, true);\r\n    if (!this.config.deleteOnStorage) {\r\n      return;\r\n    }\r\n    if (fileObject.bucket_path) {\r\n      try {\r\n        await this.storage.refFromURL(fileObject.bucket_path).delete();\r\n        console.log('form-files: clickRemoveTag() file deleted from storage', {\r\n          fileObject\r\n        });\r\n      } catch (error) {\r\n        console.log(\r\n          'form-files: clickRemoveTag() problem deleting file',\r\n          error\r\n        );\r\n      }\r\n    }\r\n  }\r\n\r\n  public onFileInputChange(files: File[]) {\r\n    if (files && files.length) {\r\n      const filesList = files;\r\n      const fileArray = Array.from(filesList);\r\n      fileArray.map((file: File) => this.beginUploadTask(file));\r\n    }\r\n  }\r\n\r\n  private async beginUploadTask(file: File) {\r\n    const bucketPath = 'gs://' + this.currentBucketName();\r\n    let uniqueFileName;\r\n    if (this.config.useUuidName) {\r\n      uniqueFileName = uuidv4() + '.' + file.name.split('.').pop();\r\n    } else {\r\n      uniqueFileName = file.name;\r\n    }\r\n    const originalFileName = file.name;\r\n    const dir = this.config.directory;\r\n    const dirPath = `${TrimSlashes(bucketPath)}/${TrimSlashes(dir)}`;\r\n    const fullPath = `${TrimSlashes(dirPath)}/${uniqueFileName}`;\r\n    console.log('beginUploadTask()', { fileData: file, bucketPath, fullPath });\r\n    let fileParsed;\r\n    if (file.type.includes('image/')) {\r\n      fileParsed = await this.parseAndCompress(file);\r\n    } else {\r\n      fileParsed = file;\r\n    }\r\n    await this.addFile(uniqueFileName, originalFileName, fullPath);\r\n    const uploadTask = this.storage.refFromURL(fullPath).put(fileParsed);\r\n    uploadTask.on(firebase.storage.TaskEvent.STATE_CHANGED, {\r\n      next: snap => this.onNext(snap, fullPath),\r\n      error: error => this.onError(error),\r\n      complete: () =>\r\n        this.onComplete(fullPath, uniqueFileName, originalFileName)\r\n    });\r\n\r\n    this.destroyed.pipe(take(1)).subscribe(() => {\r\n      uploadTask.cancel();\r\n    });\r\n  }\r\n\r\n  private addFile(\r\n    uniqueFileName: string,\r\n    originalFileName: string,\r\n    fullPath: string\r\n  ) {\r\n    const fileIcon = getFileIcon(originalFileName);\r\n    const newFile: FormFileObject = {\r\n      id: uniqueFileName,\r\n      fileicon: fileIcon,\r\n      imageurl: null,\r\n      bucket_path: fullPath,\r\n      value: {\r\n        name: originalFileName,\r\n        props: {\r\n          thumb: null,\r\n          fileicon: fileIcon,\r\n          progress: 0,\r\n          completed: false\r\n        }\r\n      }\r\n    };\r\n    const currentFiles = this.getCurrentFiles();\r\n    currentFiles.push(newFile);\r\n    this.updatesFromInternal(currentFiles, true);\r\n  }\r\n\r\n  private async parseAndCompress(file): Promise<File> {\r\n    if (\r\n      !this.config.imageCompressionMaxSize &&\r\n      !this.config.imageCompressionQuality\r\n    ) {\r\n      return file;\r\n    }\r\n    const maxWidth = this.config.imageCompressionMaxSize || 1800;\r\n    const maxQuality = this.config.imageCompressionQuality || 0.6;\r\n    const dataURL = await blobToDataURL(file);\r\n    const newDataURL = await downscaleImage(\r\n      dataURL,\r\n      maxWidth,\r\n      maxQuality,\r\n      'image/jpeg'\r\n    );\r\n    const oldKb = this.getFileSizeKiloBytes(dataURL);\r\n    const newKb = this.getFileSizeKiloBytes(newDataURL);\r\n    const fileNew = dataURItoBlob(newDataURL) as File;\r\n    console.log(`app-tags-files.component: optimized image...\r\n  --> old=${oldKb} kb\r\n  --> new=${newKb} kb`);\r\n    return fileNew;\r\n  }\r\n\r\n  private getFileSizeKiloBytes(dataURL) {\r\n    const head = 'data:image/*;base64,';\r\n    const fileSizeBytes = Math.round(((dataURL.length - head.length) * 3) / 4);\r\n    const fileSizeKiloBytes = (fileSizeBytes / 1024).toFixed(0);\r\n    return fileSizeKiloBytes;\r\n  }\r\n\r\n  private async onNext(\r\n    snapshot: firebase.storage.UploadTaskSnapshot,\r\n    fullPath: string\r\n  ) {\r\n    switch (snapshot.state) {\r\n      case firebase.storage.TaskState.RUNNING: // or 'running'\r\n        const progress =\r\n          (snapshot.bytesTransferred / snapshot.totalBytes) * 100;\r\n        const file = this.getCurrentFiles().find(\r\n          f => f.bucket_path === fullPath\r\n        );\r\n        if (!file) {\r\n          console.warn('onNext: Cannot find matching file', {\r\n            fullPath,\r\n            progress,\r\n            snapshot\r\n          });\r\n          return;\r\n        }\r\n        console.log('onNext: Upload is running', {\r\n          file,\r\n          fullPath,\r\n          progress,\r\n          snapshot\r\n        });\r\n        file.value.props.progress = progress;\r\n        break;\r\n    }\r\n  }\r\n\r\n  private onError(error) {\r\n    this.ns.notify(error.message, 'Error Uploading', true);\r\n    console.error('onError(error)', { error }, error);\r\n  }\r\n\r\n  private async onComplete(fullPath, uniqueFileName, originalFileName) {\r\n    console.log('onComplete()', {\r\n      fullPath,\r\n      uniqueFileName,\r\n      originalFileName\r\n    });\r\n    const ref = this.storage.refFromURL(fullPath);\r\n    const url = await ref.getDownloadURL();\r\n    const isImage = isFileImage(originalFileName);\r\n    const currentFiles = this.getCurrentFiles();\r\n    const file = currentFiles.find(f => f.id === uniqueFileName);\r\n    if (!file || !file.value || !file.value.props) {\r\n      return;\r\n    }\r\n    file.id = url;\r\n    if (isImage) {\r\n      file.imageurl = url;\r\n    }\r\n    file.value.props.completed = true;\r\n    this.updatesFromInternal(currentFiles, true);\r\n  }\r\n\r\n  getCurrentFiles(): FormFileObject[] {\r\n    let allFiles = this.trackedFiles;\r\n    if (!Array.isArray(allFiles)) {\r\n      allFiles = [];\r\n    }\r\n    return allFiles.filter(f => !!f);\r\n  }\r\n}\r\n","import { ControlValueAccessor, FormControl, Validator } from '@angular/forms';\r\nimport { Subject } from 'rxjs';\r\nimport { OnDestroy, OnInit, Input } from '@angular/core';\r\nimport { takeUntil, auditTime } from 'rxjs/operators';\r\nimport { ConvertToTitleCase } from './utils/case-helper';\r\nimport { v4 as uuidv4 } from 'uuid';\r\nimport { SimpleLogger } from './utils/simple-logger';\r\n\r\nexport class FormBase<T>\r\n  implements OnInit, OnDestroy, ControlValueAccessor, Validator {\r\n  internalControl: FormControl = new FormControl();\r\n  autoCompleteObscureName: string;\r\n  _destroyed = new Subject();\r\n\r\n  disabled = false;\r\n  validationError: string;\r\n\r\n  _value: T;\r\n\r\n  @Input()\r\n  formControlName: string;\r\n  @Input()\r\n  placeholder: string;\r\n  @Input()\r\n  debug: boolean;\r\n\r\n  logger: SimpleLogger;\r\n\r\n  constructor() {\r\n    // Garrentee that init and destroy are called\r\n    // even if ngOnInit() or ngOnDestroy() are overriden\r\n    const originalOnDestroy = this.ngOnDestroy;\r\n    this.ngOnDestroy = () => {\r\n      this.destroy();\r\n      originalOnDestroy.apply(this);\r\n    };\r\n    const originalOnInit = this.ngOnInit;\r\n    this.ngOnInit = () => {\r\n      this.init();\r\n      originalOnInit.apply(this);\r\n    };\r\n  }\r\n\r\n  // These will most likely be overriden\r\n  ngOnInit() {}\r\n  ngOnDestroy() {}\r\n\r\n  init() {\r\n    this.logger = new SimpleLogger(this.debug, '[form-base-class]');\r\n    this._destroyed.next();\r\n    this.autoCompleteObscureName = uuidv4();\r\n    this.internalControl.valueChanges\r\n      .pipe(takeUntil(this._destroyed))\r\n      .pipe(auditTime(100))\r\n      .subscribe((value) => {\r\n        this._value = value;\r\n        console.log('internalControl.valueChanges()', {value});\r\n        this.onChange(this._value);\r\n        this.onTouched();\r\n        // console.log('form-base-class: valueChanges', {val: this._value});\r\n      });\r\n\r\n    if (!this.placeholder) {\r\n      const nameParsed = ConvertToTitleCase(this.formControlName + '');\r\n      this.placeholder = nameParsed;\r\n    }\r\n  }\r\n\r\n  destroy() {\r\n    this._destroyed.next();\r\n  }\r\n\r\n  get value() {\r\n    return this._value;\r\n  }\r\n\r\n  set value(value) {\r\n    console.log('this.set value()', {value});\r\n    this._value = value;\r\n    this.internalControl.setValue(value, { emitEvent: true });\r\n  }\r\n\r\n  writeValue(value: any): void {\r\n    this.value = value;\r\n  }\r\n\r\n  propagateOnChange: any = () => {};\r\n  registerOnChange(fn: any): void {\r\n    this.propagateOnChange = fn;\r\n  }\r\n\r\n  onTouched: any = () => {};\r\n  registerOnTouched(fn: any): void {\r\n    this.onTouched = fn;\r\n  }\r\n\r\n  setDisabledState?(isDisabled: boolean): void {\r\n    this.disabled = isDisabled;\r\n    setTimeout(() => {\r\n      if (isDisabled) {\r\n        this.internalControl.disable();\r\n      } else {\r\n        this.internalControl.enable();\r\n      }\r\n    });\r\n  }\r\n\r\n  public validate(c: FormControl) {\r\n    const errors = c.errors;\r\n    const value = c.value;\r\n    // console.log('form-base-class: validate()', { errors, value });\r\n    this.internalControl.setValidators(c.validator);\r\n    return !this.validationError\r\n      ? null\r\n      : {\r\n          validationError: {\r\n            valid: false\r\n          }\r\n        };\r\n  }\r\n\r\n  private onChange(inputValue) {\r\n    this.validationError = this.CheckValueIsValid();\r\n    if (this.validationError) {\r\n      this.propagateOnChange(this.value);\r\n    } else {\r\n      this.propagateOnChange(inputValue);\r\n    }\r\n  }\r\n\r\n  CheckValueIsValid(): string {\r\n    return null;\r\n  }\r\n}\r\n","import {\r\n  Component,\r\n  forwardRef,\r\n  OnInit,\r\n  OnDestroy,\r\n  Input,\r\n  Output,\r\n  EventEmitter\r\n} from '@angular/core';\r\nimport { NG_VALUE_ACCESSOR, NG_VALIDATORS } from '@angular/forms';\r\nimport { FormFileObject } from '../FormFileObject';\r\nimport { Subject } from 'rxjs';\r\nimport { FormBase } from '../form-base-class';\r\nimport { NotificationService } from '../utils/notification.service';\r\nimport { MatDialog } from '@angular/material';\r\nimport { UploadsManager } from '../firebase/uploads-manager';\r\nimport { takeUntil, map } from 'rxjs/operators';\r\nimport { FormFirebaseFileConfiguration } from '../FormFirebaseFileConfiguration';\r\nimport { PreviewImagePopupComponent } from '../subcomponents/preview-images/components/preview-image-popup.component';\r\nimport { SimpleLogger } from '../utils/simple-logger';\r\n\r\n@Component({\r\n  // tslint:disable-next-line: component-selector\r\n  selector: 'form-firebase-file',\r\n  template: `\r\n    <div class=\"container\">\r\n      <span class=\"placeholder\">{{ placeholder }}</span>\r\n      <label\r\n        class=\"custom-file-upload\"\r\n        [class.dragover]=\"!disabled && isDraggingOnTop\"\r\n        (dragover)=\"isDraggingOnTop = true; $event.preventDefault()\"\r\n        (dragleave)=\"isDraggingOnTop = false\"\r\n        (drop)=\"isDraggingOnTop = false; onFileDrop($event)\"\r\n      >\r\n        <input\r\n          [hidden]=\"true\"\r\n          [placeholder]=\"placeholder\"\r\n          type=\"file\"\r\n          [disabled]=\"disabled\"\r\n          (change)=\"onFileInputChange($event)\"\r\n          [accept]=\"config?.acceptedFiles || 'image/*'\"\r\n        />\r\n        <p class=\"upload-message\">{{ uploadMessage }}</p>\r\n      </label>\r\n      <div class=\"relative\" *ngIf=\"value?.id\">\r\n        <lib-uploaded-files-list\r\n          placeholder=\"Uploaded:\"\r\n          [disabled]=\"disabled\"\r\n          [uploadedFiles]=\"[value]\"\r\n          (clickRemoveTag)=\"this.clickRemoveTag($event)\"\r\n        >\r\n        </lib-uploaded-files-list>\r\n      </div>\r\n    </div>\r\n  `,\r\n  styles: [\r\n    `\r\n      .margin10 {\r\n        margin: 10px;\r\n      }\r\n      .relative {\r\n        position: relative;\r\n      }\r\n      .container {\r\n        display: flex;\r\n        flex-direction: column;\r\n        position: relative;\r\n      }\r\n      .placeholder {\r\n        color: grey;\r\n        margin-bottom: 5px;\r\n      }\r\n      .upload-message {\r\n        font-size: 1.5em;\r\n        margin-top: 0;\r\n        margin-bottom: 10px;\r\n        text-align: center;\r\n        color: #777;\r\n        cursor: pointer;\r\n      }\r\n      .remove-btn {\r\n        position: absolute;\r\n        right: 5px;\r\n        top: 5px;\r\n      }\r\n      .custom-file-upload {\r\n        display: inline-block;\r\n        border: 4px dashed #ccc;\r\n        background: transparent;\r\n        padding: 50px 0px;\r\n        cursor: pointer;\r\n        width: calc(100% - 8px - 20px);\r\n      }\r\n      .dragover {\r\n        background: #ddd;\r\n      }\r\n      .justify-around {\r\n        justify-content: space-around;\r\n      }\r\n      .flex-h {\r\n        display: flex;\r\n        flex-direction: row;\r\n        align-items: center;\r\n      }\r\n      .has-pointer {\r\n        cursor: pointer;\r\n      }\r\n      .file-thumb {\r\n        width: auto;\r\n        max-height: 250px;\r\n        max-width: 100%;\r\n      }\r\n    `\r\n  ],\r\n  providers: [\r\n    {\r\n      provide: NG_VALUE_ACCESSOR,\r\n      useExisting: forwardRef(() => FormFirebaseFileComponent),\r\n      multi: true\r\n    },\r\n    {\r\n      provide: NG_VALIDATORS,\r\n      useExisting: forwardRef(() => FormFirebaseFileComponent),\r\n      multi: true\r\n    }\r\n  ]\r\n})\r\nexport class FormFirebaseFileComponent extends FormBase<FormFileObject>\r\n  implements OnInit, OnDestroy {\r\n  @Input()\r\n  placeholder = 'Uploaded File';\r\n  @Input()\r\n  uploadMessage = 'Upload a File Here';\r\n\r\n  private _config: FormFirebaseFileConfiguration;\r\n  @Input()\r\n  set config(config: FormFirebaseFileConfiguration) {\r\n    this._config = config || ({} as any);\r\n    this.initUploadManager();\r\n  }\r\n  get config() {\r\n    return this._config;\r\n  }\r\n\r\n  // tslint:disable-next-line: no-output-on-prefix\r\n  @Output()\r\n  uploadStatusChanged = new EventEmitter<boolean>();\r\n\r\n  destroyed = new Subject();\r\n\r\n  isDraggingOnTop = false;\r\n\r\n  hasLoaded = false;\r\n  hasError = false;\r\n  private um: UploadsManager;\r\n\r\n  constructor(public ns: NotificationService, private dialog: MatDialog) {\r\n    super();\r\n  }\r\n\r\n  ngOnInit() {}\r\n  ngOnDestroy() {\r\n    this.destroyUploadManager();\r\n  }\r\n\r\n  destroyUploadManager() {\r\n    this.destroyed.next();\r\n    if (this.um) {\r\n      this.um.onDestroy();\r\n    }\r\n  }\r\n\r\n  initUploadManager() {\r\n    this.logger = new SimpleLogger(this.debug, '[form-firebase-file]');\r\n    this.destroyUploadManager();\r\n    const $internalChangesTap = this.internalControl.valueChanges.pipe(\r\n      takeUntil(this.destroyed),\r\n      map(file => [file])\r\n    );\r\n    this.um = new UploadsManager(\r\n      this.config,\r\n      this.ns,\r\n      this.uploadStatusChanged,\r\n      $internalChangesTap,\r\n      [this.value],\r\n      this.logger\r\n    );\r\n    this.um.$currentFiles.pipe(takeUntil(this.destroyed)).subscribe(vals => {\r\n      if (Array.isArray(vals)) {\r\n        this.value = [...vals].pop();\r\n      }\r\n    });\r\n  }\r\n\r\n  writeValue(value) {\r\n    if (typeof value === 'object') {\r\n      this.value = value;\r\n    } else {\r\n      this.value = null;\r\n    }\r\n  }\r\n\r\n  onImageClicked($event, imageurl: string) {\r\n    $event.preventDefault();\r\n    $event.stopPropagation();\r\n    this.dialog.open(PreviewImagePopupComponent, {\r\n      data: imageurl,\r\n      hasBackdrop: true,\r\n      disableClose: false\r\n    });\r\n  }\r\n\r\n  async clickRemoveTag(fileObject: FormFileObject) {\r\n    this.value = null;\r\n    this.hasError = false;\r\n    this.hasLoaded = false;\r\n    this.um.clickRemoveTag(fileObject);\r\n  }\r\n\r\n  onFileInputChange(event) {\r\n    const files = event.target.files;\r\n    this.hasLoaded = false;\r\n    this.hasError = false;\r\n    this.um.onFileInputChange(files);\r\n  }\r\n\r\n  onFileDrop(event) {\r\n    event.preventDefault();\r\n    if (this.disabled) {\r\n      return;\r\n    }\r\n    const files = event.dataTransfer.files;\r\n    this.hasLoaded = false;\r\n    this.hasError = false;\r\n    this.um.onFileInputChange(files);\r\n  }\r\n}\r\n","import {\r\n  Component,\r\n  forwardRef,\r\n  OnInit,\r\n  OnDestroy,\r\n  Input,\r\n  Output,\r\n  EventEmitter\r\n} from \"@angular/core\";\r\nimport { NG_VALUE_ACCESSOR, NG_VALIDATORS } from \"@angular/forms\";\r\nimport { FormFileObject } from \"../FormFileObject\";\r\nimport * as firebase from \"firebase/app\";\r\nimport \"firebase/storage\";\r\nimport { Subject, Observable } from \"rxjs\";\r\nimport { takeUntil, tap } from \"rxjs/operators\";\r\nimport { FormBase } from \"../form-base-class\";\r\nimport { NotificationService } from \"../utils/notification.service\";\r\nimport { UploadsManager } from \"../firebase/uploads-manager\";\r\nimport { FormFirebaseFilesConfiguration } from \"../FormFirebaseFileConfiguration\";\r\nimport { SimpleLogger } from \"../utils/simple-logger\";\r\n\r\n@Component({\r\n  // tslint:disable-next-line: component-selector\r\n  selector: \"form-firebase-files\",\r\n  template: `\r\n    <div>\r\n      <label\r\n        class=\"custom-file-upload\"\r\n        [class.dragover]=\"!maxReached && !disabled && isDraggingOnTop\"\r\n        (dragover)=\"isDraggingOnTop = true; $event.preventDefault()\"\r\n        (dragleave)=\"isDraggingOnTop = false\"\r\n        (drop)=\"isDraggingOnTop = false; onFileDrop($event)\"\r\n      >\r\n        <input\r\n          *ngIf=\"isMultiple\"\r\n          [hidden]=\"true\"\r\n          type=\"file\"\r\n          multiple\r\n          [disabled]=\"disabled || maxReached\"\r\n          (change)=\"onFileInputChange($event)\"\r\n          [accept]=\"config.acceptedFiles || '*'\"\r\n        />\r\n        <input\r\n          *ngIf=\"!isMultiple\"\r\n          [hidden]=\"true\"\r\n          type=\"file\"\r\n          [disabled]=\"disabled || maxReached\"\r\n          (change)=\"onFileInputChange($event)\"\r\n          [accept]=\"config.acceptedFiles || '*'\"\r\n        />\r\n        <div class=\"flex-v\">\r\n          <span *ngIf=\"isConfigLoaded\">\r\n            {{ placeholder }}\r\n          </span>\r\n          <i *ngIf=\"disabled\">\r\n            (disabled)\r\n          </i>\r\n        </div>\r\n        <span *ngIf=\"!isConfigLoaded\">\r\n          [config] is waiting for variable config:\r\n          FormFirebaseFilesConfiguration to resolve\r\n        </span>\r\n        <div class=\"max-files\" *ngIf=\"maxReached && !disabled\">\r\n          Max Uploaded - Limit of {{ config.maxFiles }} file(s) reached. Remove\r\n          files to change uploads\r\n        </div>\r\n      </label>\r\n      <lib-uploaded-files-list\r\n        [disabled]=\"disabled\"\r\n        [uploadedFiles]=\"this.value\"\r\n        (clickRemoveTag)=\"this.clickRemoveTag($event)\"\r\n      >\r\n      </lib-uploaded-files-list>\r\n    </div>\r\n  `,\r\n  styles: [\r\n    `\r\n      .custom-file-upload {\r\n        border: 4px dashed #ccc;\r\n        display: inline-block;\r\n        padding: 35px 0px;\r\n        cursor: pointer;\r\n        width: calc(100% - 8px);\r\n        text-align: center;\r\n        font-size: 1.5em;\r\n        color: #777;\r\n      }\r\n      .dragover {\r\n        background: #ddd;\r\n      }\r\n      .max-files {\r\n        font-size: 0.9em;\r\n        color: orange;\r\n        font-style: italic;\r\n      }\r\n      .flex-v {\r\n        display: flex;\r\n        align-items: center;\r\n        flex-direction: column;\r\n      }\r\n    `\r\n  ],\r\n  providers: [\r\n    {\r\n      provide: NG_VALUE_ACCESSOR,\r\n      useExisting: forwardRef(() => FormFirebaseFilesComponent),\r\n      multi: true\r\n    },\r\n    {\r\n      provide: NG_VALIDATORS,\r\n      useExisting: forwardRef(() => FormFirebaseFilesComponent),\r\n      multi: true\r\n    }\r\n  ]\r\n})\r\nexport class FormFirebaseFilesComponent extends FormBase<FormFileObject[]>\r\n  implements OnInit, OnDestroy {\r\n  @Input()\r\n  placeholder = \"upload here\";\r\n\r\n  private _config: FormFirebaseFilesConfiguration;\r\n  @Input()\r\n  set config(config: FormFirebaseFilesConfiguration) {\r\n    this._config = config || ({} as any);\r\n    this.initUploadManager();\r\n  }\r\n  get config() {\r\n    return this._config;\r\n  }\r\n  get isConfigLoaded(): boolean {\r\n    const c = this.config;\r\n    return !!c && !!c.directory && (!!c.firebaseApp || !!c.firebaseConfig);\r\n  }\r\n  // tslint:disable-next-line: no-output-on-prefix\r\n  @Output()\r\n  uploadStatusChanged = new EventEmitter<boolean>();\r\n\r\n  destroyed = new Subject();\r\n  storage: firebase.storage.Storage;\r\n\r\n  isDraggingOnTop = false;\r\n  private um: UploadsManager;\r\n\r\n  $formChanges: Observable<FormFileObject[]>;\r\n\r\n  constructor(public ns: NotificationService) {\r\n    super();\r\n  }\r\n\r\n  writeValue(value) {\r\n    if (!Array.isArray(value)) {\r\n      value = [];\r\n    }\r\n    this.value = value;\r\n  }\r\n\r\n  ngOnInit() {}\r\n  ngOnDestroy() {\r\n    this.destroyUploadManager();\r\n  }\r\n\r\n  destroyUploadManager() {\r\n    this.destroyed.next();\r\n    if (this.um) {\r\n      this.um.onDestroy();\r\n    }\r\n  }\r\n\r\n  initUploadManager() {\r\n    this.logger = new SimpleLogger(this.debug, \"[form-firebase-files]\");\r\n    this.$formChanges = this.internalControl.valueChanges.pipe(\r\n      tap(values =>\r\n        this.logger.log(\"files.valueChanges\", { values, thisValue: this.value })\r\n      )\r\n    );\r\n    this.destroyUploadManager();\r\n    this.logger.log(\"before new UploadsManager()\", { value: this.value });\r\n    this.um = new UploadsManager(\r\n      this.config,\r\n      this.ns,\r\n      this.uploadStatusChanged,\r\n      this.$formChanges,\r\n      this.value,\r\n      this.logger\r\n    );\r\n    this.um.$currentFiles.pipe(takeUntil(this.destroyed)).subscribe(value => {\r\n      this.logger.log(\"um.$currentFiles\", { value });\r\n      this.writeValue(value);\r\n    });\r\n  }\r\n\r\n  get isMultiple() {\r\n    return this.config && this.config.maxFiles !== 1;\r\n  }\r\n\r\n  get maxReached() {\r\n    return (\r\n      this.config &&\r\n      this.config.maxFiles &&\r\n      this.value &&\r\n      this.config.maxFiles === this.value.length\r\n    );\r\n  }\r\n\r\n  async clickRemoveTag(fileObject: FormFileObject) {\r\n    this.um.clickRemoveTag(fileObject);\r\n  }\r\n\r\n  onFileInputChange(event) {\r\n    const files = event.target.files;\r\n    this.um.onFileInputChange(files);\r\n  }\r\n\r\n  onFileDrop(event) {\r\n    event.preventDefault();\r\n    if (this.maxReached || this.disabled) {\r\n      return;\r\n    }\r\n    const files = event.dataTransfer.files;\r\n    this.um.onFileInputChange(files);\r\n  }\r\n}\r\n","import {\r\n  Component,\r\n  forwardRef,\r\n  OnInit,\r\n  OnDestroy,\r\n  Input,\r\n  Output,\r\n  EventEmitter\r\n} from '@angular/core';\r\nimport { NG_VALUE_ACCESSOR, NG_VALIDATORS } from '@angular/forms';\r\nimport { FormFileObject } from '../FormFileObject';\r\nimport { Subject } from 'rxjs';\r\nimport { takeUntil, map, tap } from 'rxjs/operators';\r\nimport { FormBase } from '../form-base-class';\r\nimport { NotificationService } from '../utils/notification.service';\r\nimport { MatDialog } from '@angular/material';\r\nimport { PreviewImagePopupComponent } from '../subcomponents/preview-images/components/preview-image-popup.component';\r\nimport { UploadsManager } from '../firebase/uploads-manager';\r\nimport { FormFirebaseImageConfiguration } from '../FormFirebaseFileConfiguration';\r\nimport { SimpleLogger } from '../utils/simple-logger';\r\n\r\n@Component({\r\n  // tslint:disable-next-line: component-selector\r\n  selector: 'form-firebase-image',\r\n  template: `\r\n    <div class=\"container\">\r\n      <span class=\"placeholder\">{{ placeholder }}</span>\r\n      <label\r\n        class=\"custom-file-upload\"\r\n        [class.dragover]=\"!disabled && isDraggingOnTop\"\r\n        (dragover)=\"isDraggingOnTop = true; $event.preventDefault()\"\r\n        (dragleave)=\"isDraggingOnTop = false\"\r\n        (drop)=\"isDraggingOnTop = false; onFileDrop($event)\"\r\n      >\r\n        <input\r\n          [hidden]=\"true\"\r\n          placeholder=\"placeholder\"\r\n          type=\"file\"\r\n          [disabled]=\"disabled\"\r\n          (change)=\"onFileInputChange($event)\"\r\n          accept=\"image/*\"\r\n        />\r\n        <p class=\"upload-message\">{{ uploadMessage }}</p>\r\n        <div\r\n          class=\"flex-h max-width justify-around\"\r\n          *ngIf=\"value?.imageurl as imageurl\"\r\n        >\r\n          <div *ngIf=\"!hasLoaded && !hasError\">\r\n            <div class=\"margin10\">\r\n              <mat-progress-spinner [diameter]=\"90\" mode=\"indeterminate\">\r\n              </mat-progress-spinner>\r\n            </div>\r\n          </div>\r\n          <div class=\"relative\" [hidden]=\"!hasLoaded && !hasError\">\r\n            <button\r\n              mat-mini-fab\r\n              color=\"secondary\"\r\n              class=\"remove-btn\"\r\n              [disabled]=\"disabled\"\r\n              (click)=\"clickRemoveTag(value)\"\r\n              matTooltip=\"Click to replace current image\"\r\n            >\r\n              <mat-icon>\r\n                swap_horiz\r\n              </mat-icon>\r\n            </button>\r\n            <img\r\n              #img\r\n              class=\"file-thumb has-pointer\"\r\n              matTooltip=\"Click to preview image\"\r\n              (click)=\"onImageClicked($event, imageurl)\"\r\n              [src]=\"imageurl\"\r\n              (load)=\"hasLoaded = true\"\r\n              (error)=\"hasError = true\"\r\n            />\r\n          </div>\r\n        </div>\r\n        <div\r\n          class=\"full-width\"\r\n          *ngIf=\"(this.uploadStatusChanged | async) == true && value\"\r\n        >\r\n          <mat-progress-bar\r\n            class=\"progress\"\r\n            mode=\"determinate\"\r\n            [value]=\"value?.value?.props?.progress\"\r\n          ></mat-progress-bar>\r\n        </div>\r\n      </label>\r\n    </div>\r\n  `,\r\n  styles: [\r\n    `\r\n      .relative {\r\n        position: relative;\r\n      }\r\n      .container {\r\n        display: flex;\r\n        flex-direction: column;\r\n        position: relative;\r\n      }\r\n      .placeholder {\r\n        color: grey;\r\n        margin-bottom: 5px;\r\n      }\r\n      .upload-message {\r\n        font-size: 1.5em;\r\n        margin-top: 0;\r\n        margin-bottom: 10px;\r\n        text-align: center;\r\n        color: #777;\r\n        cursor: pointer;\r\n      }\r\n      .remove-btn {\r\n        position: absolute;\r\n        right: 5px;\r\n        top: 5px;\r\n      }\r\n      .custom-file-upload {\r\n        display: inline-block;\r\n        border: 4px dashed #ccc;\r\n        background: transparent;\r\n        padding: 10px;\r\n        cursor: pointer;\r\n        width: calc(100% - 8px - 20px);\r\n        min-height: 200px;\r\n      }\r\n      .dragover {\r\n        background: #ddd;\r\n      }\r\n      .justify-around {\r\n        justify-content: space-around;\r\n      }\r\n      .flex-h {\r\n        display: flex;\r\n        flex-direction: row;\r\n        align-items: center;\r\n      }\r\n      .has-pointer {\r\n        cursor: pointer;\r\n      }\r\n      .file-thumb {\r\n        width: auto;\r\n        max-height: 250px;\r\n        max-width: 100%;\r\n      }\r\n    `\r\n  ],\r\n  providers: [\r\n    {\r\n      provide: NG_VALUE_ACCESSOR,\r\n      useExisting: forwardRef(() => FormFirebaseImageComponent),\r\n      multi: true\r\n    },\r\n    {\r\n      provide: NG_VALIDATORS,\r\n      useExisting: forwardRef(() => FormFirebaseImageComponent),\r\n      multi: true\r\n    }\r\n  ]\r\n})\r\nexport class FormFirebaseImageComponent extends FormBase<FormFileObject>\r\n  implements OnInit, OnDestroy {\r\n  @Input()\r\n  placeholder = 'Attached Files';\r\n  @Input()\r\n  uploadMessage = 'Upload an Image Here';\r\n  private _config: FormFirebaseImageConfiguration;\r\n  @Input()\r\n  set config(config: FormFirebaseImageConfiguration) {\r\n    this._config = config || ({} as any);\r\n    this.initUploadManager();\r\n  }\r\n  get config() {\r\n    return this._config;\r\n  }\r\n  get isConfigLoaded(): boolean {\r\n    const c = this.config;\r\n    return !!c && !!c.directory && (!!c.firebaseApp || !!c.firebaseConfig);\r\n  }\r\n\r\n  // tslint:disable-next-line: no-output-on-prefix\r\n  @Output()\r\n  uploadStatusChanged = new EventEmitter<boolean>();\r\n\r\n  destroyed = new Subject();\r\n\r\n  isDraggingOnTop = false;\r\n\r\n  hasLoaded = false;\r\n  hasError = false;\r\n  private um: UploadsManager;\r\n\r\n  constructor(public ns: NotificationService, private dialog: MatDialog) {\r\n    super();\r\n  }\r\n\r\n  writeValue(value) {\r\n    if (typeof value === 'object') {\r\n      this.value = value;\r\n    } else {\r\n      this.value = null;\r\n    }\r\n  }\r\n\r\n  ngOnInit() {}\r\n  ngOnDestroy() {\r\n    this.destroyUploadManager();\r\n  }\r\n\r\n  destroyUploadManager() {\r\n    this.destroyed.next();\r\n    if (this.um) {\r\n      this.um.onDestroy();\r\n    }\r\n  }\r\n\r\n  initUploadManager() {\r\n    this.logger = new SimpleLogger(this.debug, '[form-firebase-image]');\r\n    this.destroyUploadManager();\r\n    const $internalChangesTap = this.internalControl.valueChanges.pipe(\r\n      takeUntil(this.destroyed),\r\n      tap(files => this.logger.log('$internalChangesTap', {files})),\r\n      map(file => [file])\r\n    );\r\n    this.um = new UploadsManager(\r\n      this.config,\r\n      this.ns,\r\n      this.uploadStatusChanged,\r\n      $internalChangesTap,\r\n      [this.value],\r\n      this.logger\r\n    );\r\n    this.um.$currentFiles.pipe(takeUntil(this.destroyed)).subscribe(vals => {\r\n      if (Array.isArray(vals)) {\r\n        this.value = [...vals].pop();\r\n      }\r\n    });\r\n  }\r\n\r\n  onImageClicked($event, imageurl: string) {\r\n    $event.preventDefault();\r\n    $event.stopPropagation();\r\n    this.dialog.open(PreviewImagePopupComponent, {\r\n      data: imageurl,\r\n      hasBackdrop: true,\r\n      disableClose: false\r\n    });\r\n  }\r\n\r\n  async clickRemoveTag(fileObject: FormFileObject) {\r\n    this.value = null;\r\n    this.hasError = false;\r\n    this.hasLoaded = false;\r\n    this.um.clickRemoveTag(fileObject);\r\n  }\r\n\r\n  onFileInputChange(event) {\r\n    const files = event.target.files;\r\n    this.hasLoaded = false;\r\n    this.hasError = false;\r\n    this.um.onFileInputChange(files);\r\n  }\r\n\r\n  onFileDrop(event) {\r\n    event.preventDefault();\r\n    if (this.disabled) {\r\n      return;\r\n    }\r\n    const files = event.dataTransfer.files;\r\n    this.hasLoaded = false;\r\n    this.hasError = false;\r\n    this.um.onFileInputChange(files);\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\nimport {\r\n  MatInputModule,\r\n  MatIconModule,\r\n  MatProgressBarModule,\r\n  MatSnackBarModule,\r\n  MatDialogModule,\r\n  MatProgressSpinnerModule,\r\n  MatButtonModule,\r\n  MatTooltipModule\r\n} from '@angular/material';\r\nimport { CommonModule } from '@angular/common';\r\nimport { NotificationService } from './utils/notification.service';\r\nimport { FormFileUploadedFileListComponent } from './subcomponents/form-file-uploader-list.component';\r\nimport { FormFirebaseImageComponent } from './form-controls/form-firebase-image.component';\r\nimport { FormFirebaseFilesComponent } from './form-controls/form-firebase-files.component';\r\nimport { FormFirebaseFilesViewerComponent } from './subcomponents/form-firebase-files-viewer.component';\r\nimport { FormFirebaseFileComponent } from './form-controls/form-firebase-file.component';\r\nimport { LibPreviewImagesModule } from './subcomponents/preview-images/lib-preview-images.module';\r\n\r\nconst shared = [\r\n  FormFirebaseFilesComponent,\r\n  FormFirebaseFileComponent,\r\n  FormFirebaseImageComponent,\r\n  FormFirebaseFilesViewerComponent,\r\n];\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    ReactiveFormsModule,\r\n    MatDialogModule,\r\n    MatButtonModule,\r\n    MatTooltipModule,\r\n    MatProgressBarModule,\r\n    MatProgressSpinnerModule,\r\n    MatSnackBarModule,\r\n    MatInputModule,\r\n    MatIconModule,\r\n    LibPreviewImagesModule\r\n  ],\r\n  exports: [...shared, LibPreviewImagesModule],\r\n  declarations: [FormFileUploadedFileListComponent, ...shared],\r\n  providers: [NotificationService]\r\n})\r\nexport class MatFirebaseUploadModule {}\r\n","import { EventEmitter, Component, Input, Output } from '@angular/core';\r\nimport { FormFileObject } from '../FormFileObject';\r\nimport { MatDialog } from '@angular/material';\r\nimport { PreviewImagePopupComponent } from './preview-images/components/preview-image-popup.component';\r\n\r\n@Component({\r\n  selector: 'lib-uploaded-files-list',\r\n  template: `\r\n    <p *ngIf=\"uploadedFiles?.length\">{{placeholder}}</p>\r\n    <div>\r\n      <div *ngFor=\"let file of uploadedFiles\">\r\n        <div class=\"full-width flex-h justify-between\">\r\n          <div class=\"flex-h has-ellipsis\">\r\n            <mat-icon *ngIf=\"!disabled && isDone(file)\">done</mat-icon>\r\n            <a class=\"flex-h has-ellipsis\" [href]=\"file.id\" target=\"_blank\">\r\n              <img class=\"file-icon\" image [src]=\"file['fileicon']\" />\r\n              <span class=\"has-ellipsis\">{{ file.value.name }}</span>\r\n              <mat-icon class=\"i-open\">open_in_new</mat-icon>\r\n            </a>\r\n          </div>\r\n          <div class=\"flex-h\">\r\n            <div class=\"flex-h\" *ngIf=\"file['imageurl'] as imageurl\">\r\n              <div\r\n                class=\"full-width\"\r\n                *ngIf=\"!img.hasLoaded && !img.hasError\"\r\n              >\r\n                <div class=\"margin10\">\r\n                  <mat-progress-spinner [diameter]=\"30\" mode=\"indeterminate\">\r\n                  </mat-progress-spinner>\r\n                </div>\r\n              </div>\r\n              <img\r\n                #img\r\n                class=\"file-thumb has-pointer\"\r\n                matTooltip=\"Click to preview image\"\r\n                (click)=\"clickedImage(imageurl)\"\r\n                [src]=\"imageurl\"\r\n                [hidden]=\"!img.hasLoaded && !img.hasError\"\r\n                (load)=\"img.hasLoaded = true\"\r\n                (error)=\"img.hasError = true\"\r\n              />\r\n            </div>\r\n            <mat-icon\r\n              *ngIf=\"!disabled\"\r\n              class=\"has-pointer\"\r\n              (click)=\"this.clickRemoveTag.emit(file)\"\r\n              >cancel</mat-icon\r\n            >\r\n          </div>\r\n        </div>\r\n        <div class=\"full-width\">\r\n          <mat-progress-bar\r\n            class=\"progress\"\r\n            mode=\"determinate\"\r\n            [value]=\"getProgress(file)\"\r\n          ></mat-progress-bar>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  `,\r\n  styles: [\r\n    `\r\n      .full-width {\r\n        width: 100%;\r\n      }\r\n      .flex-h {\r\n        display: flex;\r\n        flex-direction: row;\r\n        align-items: center;\r\n      }\r\n      .justify-between {\r\n        justify-content: space-between;\r\n      }\r\n      .has-pointer {\r\n        cursor: pointer;\r\n      }\r\n      .file-link {\r\n        display: flex;\r\n        align-items: center;\r\n      }\r\n      .file-thumb,\r\n      .file-icon {\r\n        margin: 3px;\r\n        height: 30px;\r\n        width: auto;\r\n        max-width: 60px;\r\n      }\r\n      .file-thumb {\r\n        background-color: #ddd;\r\n      }\r\n      .i-open {\r\n        font-size: 1em;\r\n      }\r\n      .has-ellipsis {\r\n        text-overflow: ellipsis;\r\n        overflow: hidden;\r\n        white-space: nowrap;\r\n      }\r\n    `\r\n  ]\r\n})\r\nexport class FormFileUploadedFileListComponent {\r\n  @Input()\r\n  placeholder = 'Uploaded Files:';\r\n  @Input()\r\n  disabled: boolean;\r\n  @Input()\r\n  uploadedFiles: FormFileObject[] = [];\r\n  @Output()\r\n  clickRemoveTag = new EventEmitter<FormFileObject>();\r\n\r\n  constructor(private dialog: MatDialog) {}\r\n\r\n  clickedImage(imageurl: string) {\r\n    this.dialog.open(PreviewImagePopupComponent, {\r\n      data: imageurl,\r\n      hasBackdrop: true,\r\n      disableClose: false\r\n    });\r\n  }\r\n\r\n  getProgress(file: FormFileObject) {\r\n    const isDone = this.isDone(file);\r\n    if (isDone) {\r\n      return 100;\r\n    }\r\n    if (file && file.value && file.value.props) {\r\n      const p = file.value.props.progress;\r\n      return p * 0.95; // 95% until download completed\r\n    }\r\n    return 100;\r\n  }\r\n\r\n  isDone(file: FormFileObject): boolean {\r\n    if (file && file.value && file.value.props) {\r\n      const isCompleted =\r\n        file.value.props.completed || file.value.props.progress === 100;\r\n      return isCompleted;\r\n    }\r\n    return false;\r\n  }\r\n}\r\n","import { Component, Input } from '@angular/core';\nimport { FormFileObject } from '../FormFileObject';\n\n@Component({\n  selector: 'form-firebase-files-viewer',\n  template: `\n    <ng-template #noFiles>\n      <h4 class=\"no-files\">\n        {{ placeholder }}\n      </h4>\n    </ng-template>\n    <lib-uploaded-files-list\n      *ngIf=\"value?.length; else noFiles\"\n      [disabled]=\"true\"\n      [uploadedFiles]=\"value\"\n    >\n    </lib-uploaded-files-list>\n  `,\n  styles: [\n    `\n      .no-files {\n        color: grey;\n        text-align: center;\n      }\n    `\n  ]\n})\nexport class FormFirebaseFilesViewerComponent {\n  @Input()\n  value: FormFileObject[];\n  @Input()\n  placeholder = 'No Files...';\n}\n","import { Component, Input } from '@angular/core';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { PreviewImagePopupComponent } from './preview-image-popup.component';\r\n\r\n@Component({\r\n  selector: 'img-with-loader',\r\n  template: `\r\n    <div\r\n      class=\"container\"\r\n      [ngStyle]=\"{ 'padding-bottom': aspectRatio * 100 + '%' }\"\r\n      [class.height-auto]=\"!hasLoaded\"\r\n    >\r\n      <div class=\"full-width justify bg-grey\" *ngIf=\"!hasLoaded\">\r\n        <div class=\"margin10\">\r\n          <mat-progress-spinner [diameter]=\"80\" mode=\"indeterminate\">\r\n          </mat-progress-spinner>\r\n        </div>\r\n      </div>\r\n      <img\r\n        image\r\n        #img\r\n        class=\"image-fit has-pointer\"\r\n        [hidden]=\"!hasLoaded && !hasError\"\r\n        (click)=\"clickedImage(src)\"\r\n        [src]=\"src\"\r\n        (load)=\"onLoaded(img); hasLoaded = true\"\r\n        (error)=\"hasError = true\"\r\n      />\r\n    </div>\r\n  `,\r\n  styles: [\r\n    `\r\n      .bg-grey {\r\n        background-color: #dddddd78;\r\n      }\r\n      .justify {\r\n        display: flex;\r\n        justify-content: center;\r\n      }\r\n      .full-width {\r\n        width: 100%;\r\n      }\r\n      .margin10 {\r\n        margin: 50px;\r\n      }\r\n      .container {\r\n        position: relative;\r\n        height: 0;\r\n      }\r\n      .image-fit {\r\n        position: absolute;\r\n        left: 0;\r\n        top: 0;\r\n        height: 100%;\r\n        width: 100%;\r\n        object-fit: cover;\r\n        object-position: center center;\r\n      }\r\n      .height-auto {\r\n        height: auto;\r\n      }\r\n      .has-pointer {\r\n        cursor: pointer;\r\n      }\r\n      :host {\r\n        display: block;\r\n        left: 0;\r\n        width: 100%;\r\n        height: 100%;\r\n      }\r\n    `\r\n  ]\r\n})\r\nexport class LibImgWithLoaderComponent {\r\n  hasLoaded = false;\r\n  hasError = false;\r\n\r\n  aspectRatio = 0;\r\n\r\n  // tslint:disable-next-line: variable-name\r\n  private _src: string;\r\n  @Input()\r\n  set src(src: string) {\r\n    this.hasError = false;\r\n    this.hasLoaded = false;\r\n    this._src = src;\r\n  }\r\n  get src() {\r\n    return this._src;\r\n  }\r\n\r\n  constructor(private dialog: MatDialog) {}\r\n\r\n  clickedImage(imageurl: string) {\r\n    this.dialog.open(PreviewImagePopupComponent, {\r\n      data: imageurl,\r\n      hasBackdrop: true,\r\n      disableClose: false\r\n    });\r\n  }\r\n\r\n  onLoaded(img: HTMLImageElement) {\r\n    console.log({ img });\r\n    const { naturalHeight, naturalWidth } = img;\r\n    this.aspectRatio = naturalHeight / naturalWidth;\r\n  }\r\n}\r\n","import { Component, Input } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'preview-gallery',\r\n  template: `\r\n    <div class=\"gallery\">\r\n      <div class=\"gallery-item\" *ngFor=\"let url of imageUrls\">\r\n        <preview-image [src]=\"url\" [aspectRatio]=\"1\"> </preview-image>\r\n      </div>\r\n    </div>\r\n  `,\r\n  styles: [\r\n    `\r\n      .gallery {\r\n        display: flex;\r\n      }\r\n      .gallery-item {\r\n        margin-right: 15px;\r\n        margin-top: 15px;\r\n        width: 100px;\r\n      }\r\n    `\r\n  ]\r\n})\r\nexport class PreviewGalleryComponent {\r\n  _imageUrls: string[];\r\n  @Input()\r\n  set imageUrls(imageUrls: string[]) {\r\n    if (imageUrls) {\r\n      this._imageUrls = imageUrls;\r\n    } else {\r\n      this._imageUrls = ['https://via.placeholder.com/100x100'];\r\n    }\r\n  }\r\n  get imageUrls() {\r\n    return this._imageUrls;\r\n  }\r\n  @Input()\r\n  aspectRatio = 1;\r\n}\r\n","import { Component, Inject } from '@angular/core';\r\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material';\r\n\r\n@Component({\r\n  selector: 'preview-image-popup',\r\n  template: `\r\n    <div class=\"relative\">\r\n      <button class=\"absolute z1 btn-close\" mat-mini-fab (click)=\"onCancel()\">\r\n        <mat-icon>clear</mat-icon>\r\n      </button>\r\n      <a\r\n        class=\"absolute z1 btn-download\"\r\n        mat-mini-fab\r\n        target=\"_blank\"\r\n        [href]=\"imageSrc\"\r\n      >\r\n        <mat-icon>open_in_new</mat-icon>\r\n      </a>\r\n      <div\r\n        class=\"justify bg-grey\"\r\n        *ngIf=\"!img.hasLoaded && !img.hasError\"\r\n      >\r\n        <div class=\"margin10\">\r\n          <mat-progress-spinner [diameter]=\"90\" mode=\"indeterminate\">\r\n          </mat-progress-spinner>\r\n        </div>\r\n      </div>\r\n      <img\r\n        #img\r\n        class=\"fill\"\r\n        [src]=\"imageSrc\"\r\n        [hidden]=\"!img.hasLoaded && !img.hasError\"\r\n        (load)=\"img.hasLoaded = true\"\r\n        (error)=\"img.hasError = true\"\r\n      />\r\n    </div>\r\n  `,\r\n  styles: [\r\n    `\r\n      .z1 {\r\n        z-index: 1;\r\n      }\r\n      .relative {\r\n        position: relative;\r\n      }\r\n      .absolute {\r\n        position: absolute;\r\n      }\r\n      .btn-close {\r\n        right: 10px;\r\n        top: 10px;\r\n      }\r\n      .btn-download {\r\n        right: 10px;\r\n        bottom: 10px;\r\n      }\r\n      .bg-grey {\r\n        background-color: #dddddd78;\r\n      }\r\n      .margin10 {\r\n        margin: 70px;\r\n      }\r\n      .justify {\r\n        display: flex;\r\n        justify-content: center;\r\n      }\r\n      .fill {\r\n        max-height: 90vh;\r\n        max-width: 100%;\r\n      }\r\n    `\r\n  ]\r\n})\r\nexport class PreviewImagePopupComponent {\r\n  constructor(\r\n    public dialogRef: MatDialogRef<PreviewImagePopupComponent>,\r\n    @Inject(MAT_DIALOG_DATA) public imageSrc: string\r\n  ) {}\r\n  \r\n  onCancel() {\r\n    this.dialogRef.close();\r\n  }\r\n}\r\n","import { Component, Input } from '@angular/core';\r\nimport { DomSanitizer } from '@angular/platform-browser';\r\nimport { MatDialog } from '@angular/material';\r\nimport { PreviewImagePopupComponent } from './preview-image-popup.component';\r\n\r\n@Component({\r\n  selector: 'preview-image',\r\n  template: `\r\n    <div class=\"outer\">\r\n      <div\r\n        class=\"outer-before\"\r\n        [style.paddingTop]=\"\r\n          sanitizer.bypassSecurityTrustStyle(\r\n            'calc(1/(' + aspectRatio + ') * 100%)'\r\n          )\r\n        \"\r\n      ></div>\r\n      <div\r\n        class=\"inner has-pointer\"\r\n        [style.backgroundImage]=\"'url(' + src + ')'\"\r\n        [style.backgroundSize]=\"'cover'\"\r\n        (click)=\"clickedImage()\"\r\n      ></div>\r\n    </div>\r\n  `,\r\n  styles: [\r\n    `\r\n      /* made with: https://ratiobuddy.com/ */\r\n      .outer {\r\n        position: relative;\r\n      }\r\n      .outer-before {\r\n        display: block;\r\n        content: '';\r\n        width: 100%;\r\n        padding-top: 50%; /* default aspect ratio */\r\n      }\r\n      .outer > .inner {\r\n        position: absolute;\r\n        top: 0;\r\n        right: 0;\r\n        bottom: 0;\r\n        left: 0;\r\n        overflow: hidden;\r\n      }\r\n      .has-pointer {\r\n        cursor: pointer;\r\n      }\r\n\r\n      img {\r\n        width: 100%;\r\n      }\r\n    `\r\n  ]\r\n})\r\nexport class PreviewImageComponent {\r\n  _src: string;\r\n  @Input()\r\n  set src(src: string) {\r\n    if (src) {\r\n      this._src = src;\r\n    } else {\r\n      this._src = 'https://via.placeholder.com/200x100';\r\n    }\r\n  }\r\n  get src() {\r\n    return this._src;\r\n  }\r\n  @Input()\r\n  aspectRatio = 1;\r\n\r\n  constructor(public sanitizer: DomSanitizer, private dialog: MatDialog) {}\r\n\r\n  async clickedImage() {\r\n    const ref = this.dialog.open(PreviewImagePopupComponent, {\r\n      hasBackdrop: true,\r\n      data: this.src\r\n    });\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { PreviewImageComponent } from './components/preview-image.component';\r\nimport { PreviewGalleryComponent } from './components/preview-gallery.component';\r\nimport {\r\n  MatDialogModule,\r\n  MatButtonModule,\r\n  MatIconModule,\r\n  MatProgressSpinnerModule\r\n} from '@angular/material';\r\nimport { PreviewImagePopupComponent } from './components/preview-image-popup.component';\r\nimport { LibImgWithLoaderComponent } from './components/img-with-loader.component';\r\n\r\nconst exportedComponents = [\r\n  PreviewImageComponent,\r\n  PreviewGalleryComponent,\r\n  LibImgWithLoaderComponent\r\n];\r\n\r\n@NgModule({\r\n  entryComponents: [PreviewImagePopupComponent],\r\n  declarations: [...exportedComponents, PreviewImagePopupComponent],\r\n  exports: [...exportedComponents],\r\n  imports: [\r\n    CommonModule,\r\n    MatDialogModule,\r\n    MatButtonModule,\r\n    MatProgressSpinnerModule,\r\n    MatIconModule\r\n  ]\r\n})\r\nexport class LibPreviewImagesModule {}\r\n","export function ConvertToTitleCase(input: string): string {\r\n  const capitalsWithSpaces = input.replace(/([A-Z])/g, ' $1').trim();\r\n  const underscoresToSpaces = capitalsWithSpaces.replace(/_/g, ' ');\r\n  return underscoresToSpaces\r\n    .split(' ')\r\n    .map(p => p.charAt(0).toUpperCase() + p.substr(1).toLowerCase())\r\n    .join(' ');\r\n}\r\n","export interface FileIcon {\r\n  /**\r\n   * Name of the icon, e.g. 'javascript'\r\n   */\r\n  name: string;\r\n\r\n  /**\r\n   * Define the file extensions that should use this icon.\r\n   * E.g. ['js']\r\n   */\r\n  fileExtensions?: string[];\r\n\r\n  /**\r\n   * Define if there are some static file names that should apply this icon.\r\n   * E.g. ['sample.js']\r\n   */\r\n  fileNames?: string[];\r\n\r\n  /**\r\n   * Define if there is a light icon available.\r\n   */\r\n  light?: boolean;\r\n\r\n  /**\r\n   * Define if there is a high contrast icon available.\r\n   */\r\n  highContrast?: boolean;\r\n\r\n  /**\r\n   * Define if the icon should be disabled.\r\n   */\r\n  disabled?: boolean;\r\n}\r\n\r\nexport interface FolderTheme {\r\n  /**\r\n   * Name of the theme\r\n   */\r\n  name: string;\r\n\r\n  /**\r\n   * Define the default icon for folders in a theme.\r\n   */\r\n  defaultIcon: DefaultIcon;\r\n\r\n  /**\r\n   * Icon for root folders.\r\n   */\r\n  rootFolder?: DefaultIcon;\r\n\r\n  /**\r\n   * Defines folder icons for specific folder names.\r\n   */\r\n  icons?: FolderIcon[];\r\n}\r\n\r\nexport interface FolderIcon {\r\n  /**\r\n   * Name of the icon, e.g. 'src'\r\n   */\r\n  name: string;\r\n\r\n  /**\r\n   * Define the folder names that should apply the icon.\r\n   * E.g. ['src', 'source']\r\n   */\r\n  folderNames: string[];\r\n\r\n  /**\r\n   * Define if there is a light icon available.\r\n   */\r\n  light?: boolean;\r\n\r\n  /**\r\n   * Define if there is a high contrast icon available.\r\n   */\r\n  highContrast?: boolean;\r\n\r\n  /**\r\n   * Define if the icon should be disabled.\r\n   */\r\n  disabled?: boolean;\r\n}\r\n\r\nexport interface DefaultIcon {\r\n  /**\r\n   * Name of the icon, e.g. 'src'\r\n   */\r\n  name: string;\r\n\r\n  /**\r\n   * Define if there is a light icon available.\r\n   */\r\n  light?: boolean;\r\n\r\n  /**\r\n   * Define if there is a high contrast icon available.\r\n   */\r\n  highContrast?: boolean;\r\n}\r\n\r\nexport class FileIcons {\r\n  /**\r\n   * Define the default icon for files.\r\n   */\r\n  defaultIcon: DefaultIcon;\r\n\r\n  /**\r\n   * Defines all folder icons.\r\n   */\r\n  icons?: FileIcon[];\r\n}\r\n\r\nexport const fileIcons: FileIcons = {\r\n  defaultIcon: { name: 'file' },\r\n  icons: [\r\n    { name: 'word', fileExtensions: ['doc', 'docx', 'rtf'] },\r\n    { name: 'pdf', fileExtensions: ['pdf'] },\r\n    { name: 'table', fileExtensions: ['xlsx', 'xls', 'csv', 'tsv'] },\r\n    {\r\n      name: 'html',\r\n      fileExtensions: ['html', 'htm', 'xhtml', 'html_vm', 'asp']\r\n    },\r\n    {\r\n      name: 'markdown',\r\n      fileExtensions: ['md', 'markdown', 'rst']\r\n    },\r\n    { name: 'yaml', fileExtensions: ['yaml', 'YAML-tmLanguage', 'yml'] },\r\n    {\r\n      name: 'xml',\r\n      fileExtensions: [\r\n        'xml',\r\n        'plist',\r\n        'xsd',\r\n        'dtd',\r\n        'xsl',\r\n        'xslt',\r\n        'resx',\r\n        'iml',\r\n        'xquery',\r\n        'tmLanguage',\r\n        'manifest',\r\n        'project'\r\n      ],\r\n      fileNames: ['.htaccess']\r\n    },\r\n    {\r\n      name: 'image',\r\n      fileExtensions: [\r\n        'png',\r\n        'jpeg',\r\n        'jpg',\r\n        'gif',\r\n        'svg',\r\n        'ico',\r\n        'tif',\r\n        'tiff',\r\n        'psd',\r\n        'psb',\r\n        'ami',\r\n        'apx',\r\n        'bmp',\r\n        'bpg',\r\n        'brk',\r\n        'cur',\r\n        'dds',\r\n        'dng',\r\n        'exr',\r\n        'fpx',\r\n        'gbr',\r\n        'img',\r\n        'jbig2',\r\n        'jb2',\r\n        'jng',\r\n        'jxr',\r\n        'pbm',\r\n        'pgf',\r\n        'pic',\r\n        'raw',\r\n        'webp',\r\n        'eps'\r\n      ]\r\n    },\r\n    { name: 'tex', fileExtensions: ['tex', 'cls', 'sty'] },\r\n    {\r\n      name: 'powerpoint',\r\n      fileExtensions: [\r\n        'pptx',\r\n        'ppt',\r\n        'pptm',\r\n        'potx',\r\n        'potm',\r\n        'ppsx',\r\n        'ppsm',\r\n        'pps',\r\n        'ppam',\r\n        'ppa'\r\n      ]\r\n    },\r\n    {\r\n      name: 'video',\r\n      fileExtensions: [\r\n        'webm',\r\n        'mkv',\r\n        'flv',\r\n        'vob',\r\n        'ogv',\r\n        'ogg',\r\n        'gifv',\r\n        'avi',\r\n        'mov',\r\n        'qt',\r\n        'wmv',\r\n        'yuv',\r\n        'rm',\r\n        'rmvb',\r\n        'mp4',\r\n        'm4v',\r\n        'mpg',\r\n        'mp2',\r\n        'mpeg',\r\n        'mpe',\r\n        'mpv',\r\n        'm2v'\r\n      ]\r\n    },\r\n    { name: 'audio', fileExtensions: ['mp3', 'flac', 'm4a', 'wma', 'aiff'] },\r\n    { name: 'document', fileExtensions: ['txt'] }\r\n  ]\r\n};\r\n\r\nexport const getFileIconName = (filename: string) => {\r\n  filename = filename.toLowerCase();\r\n  if (!filename || !filename.includes('.')) {\r\n    return fileIcons.defaultIcon.name;\r\n  }\r\n  const ext = getFileExtension(filename);\r\n  const matchesExt = fileIcons.icons.filter(\r\n    x => !!x.fileExtensions && !!x.fileExtensions.filter(y => y === ext).length\r\n  );\r\n  const matchesFilename = fileIcons.icons.filter(\r\n    x => !!x.fileNames && !!x.fileNames.filter(y => y === filename).length\r\n  );\r\n  if (!!matchesFilename.length) {\r\n    return matchesFilename[0].name;\r\n  } else if (!!matchesExt.length) {\r\n    return matchesExt[0].name;\r\n  }\r\n\r\n  return fileIcons.defaultIcon.name;\r\n};\r\n\r\nexport const isFileImage = (filename: string) =>\r\n  getFileIconName(filename) === 'image';\r\n\r\nexport const getFileExtension = (filename: string) => filename.split('.').pop();\r\n\r\nexport const getFileName = (filename: string) =>\r\n  filename.split('.').slice(-2, -1)[0];\r\n\r\nexport const getFileIcon = (filename: string) => {\r\n  return '/assets/fileicons/' + getFileIconName(filename) + '.svg';\r\n};\r\n","\n// **blob to dataURL**\nexport async function blobToDataURL(blob): Promise<string> {\n  const reader = new FileReader();\n  return new Promise<string>((resolve, reject) => {\n    reader.onload = function(e: any) {\n      resolve(e.target.result as string);\n    };\n    reader.onerror = function(error: any) {\n      reject(error);\n    };\n    reader.readAsDataURL(blob);\n  });\n}\n\n// Dataurl to blob\nexport function dataURItoBlob(dataURI) {\n  // convert base64 to raw binary data held in a string\n  // doesn't handle URLEncoded DataURIs - see SO answer #6850276 for code that does this\n  const byteString = atob(dataURI.split(',')[1]);\n\n  // separate out the mime component\n  const mimeString = dataURI\n    .split(',')[0]\n    .split(':')[1]\n    .split(';')[0];\n\n  // write the bytes of the string to an ArrayBuffer\n  const ab = new ArrayBuffer(byteString.length);\n\n  // create a view into the buffer\n  const ia = new Uint8Array(ab);\n\n  // set the bytes of the buffer to the correct values\n  for (let i = 0; i < byteString.length; i++) {\n    ia[i] = byteString.charCodeAt(i);\n  }\n\n  // write the ArrayBuffer to a blob, and you're done\n  const blob = new Blob([ab], { type: mimeString });\n  return blob;\n}\n\n// Take an image URL, downscale it to the given width, and return a new image URL.\nexport async function downscaleImage(\n  dataUrl: string,\n  newWidth: number,\n  imageQuality: number,\n  imageType: string,\n  debug?: boolean\n) {\n  // Provide default values\n  imageType = imageType || 'image/jpeg';\n  imageQuality = imageQuality || 0.7;\n\n  // Create a temporary image so that we can compute the height of the downscaled image.\n  const image = new Image();\n  image.src = dataUrl;\n  await new Promise(resolve => {\n    image.onload = () => {\n      resolve();\n    };\n  });\n  const oldWidth = image.width;\n  const oldHeight = image.height;\n  const newHeight = Math.floor((oldHeight / oldWidth) * newWidth);\n\n  // Create a temporary canvas to draw the downscaled image on.\n  const canvas = document.createElement('canvas');\n  canvas.width = newWidth;\n  canvas.height = newHeight;\n\n  // Draw the downscaled image on the canvas and return the new data URL.\n  const ctx = canvas.getContext('2d');\n  ctx.drawImage(image, 0, 0, newWidth, newHeight);\n  const newDataUrl = canvas.toDataURL(imageType, imageQuality);\n  if (debug) {\n    console.log('quill.imageCompressor: downscaling image...', {\n      args: {\n        dataUrl,\n        newWidth,\n        imageType,\n        imageQuality\n      },\n      image,\n      oldWidth,\n      oldHeight,\n      newHeight,\n      canvas,\n      ctx,\n      newDataUrl\n    });\n  }\n  return newDataUrl;\n}\n","export * from './case-helper';\nexport * from './file-icon.helper';\nexport * from './img-helpers';\nexport * from './notification.service';\nexport * from './path-helpers';\n","import { Injectable } from '@angular/core';\r\nimport { MatSnackBar } from '@angular/material';\r\n\r\n@Injectable()\r\nexport class NotificationService {\r\n  constructor(private matSnackbar: MatSnackBar) {}\r\n\r\n  public notify(msg: string, title?: string, isError?: boolean) {\r\n    return this.matSnackbar.open(msg, title, {\r\n      duration: 4000,\r\n      horizontalPosition: 'center',\r\n      verticalPosition: 'bottom'\r\n    });\r\n  }\r\n\r\n  public notifyCancelled() {\r\n    return this.notify('Cancelled Operation');\r\n  }\r\n}\r\n","export function TrimSlashes(inputPath: string): string {\r\n  return inputPath.replace(/^\\/+|\\/+$/g, '');\r\n}\r\n","export class SimpleLogger {\n  constructor(\n    private debug: boolean,\n    private logPrefix: string = 'simple-logger:: '\n  ) {}\n\n  public get log() {\n    if (!this.debug) {\n      return (...any) => {};\n    }\n    const boundLogFn: (...any) => void = console.log.bind(\n      console,\n      this.logPrefix\n    );\n    return boundLogFn;\n  }\n\n  public get warn() {\n    if (!this.debug) {\n      return (...any) => {};\n    }\n    const boundLogFn: (...any) => void = console.warn.bind(\n      console,\n      this.logPrefix\n    );\n    return boundLogFn;\n  }\n}\n","/*\r\n * Public API Surface of mat-firebase-upload\r\n */\r\n\r\nexport * from './lib/lib.module';\r\nexport * from './lib/form-controls/form-firebase-file.component';\r\nexport * from './lib/form-controls/form-firebase-files.component';\r\nexport * from './lib/form-controls/form-firebase-image.component';\r\nexport * from './lib/FormFileObject';\r\nexport * from './lib/FormFirebaseFileConfiguration';\r\n","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"./$$_lazy_route_resource lazy recursive\";","import { Component, OnInit } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-root',\r\n  template: `\r\n    <ul>\r\n      <h1>Mat Firebase Upload</h1>\r\n      <li><a routerLink=\"form-firebase-file\">form-firebase-file</a></li>\r\n      <li><a routerLink=\"form-firebase-files\">form-firebase-files</a></li>\r\n      <li><a routerLink=\"form-firebase-image\">form-firebase-image</a></li>\r\n      <li><a routerLink=\"form-firebase-viewers\">form-firebase-viewers</a></li>\r\n    </ul>\r\n    <router-outlet> </router-outlet>\r\n  `\r\n})\r\nexport class AppComponent implements OnInit {\r\n  constructor() {}\r\n\r\n  async ngOnInit() {}\r\n}\r\n","import { BrowserModule } from '@angular/platform-browser';\r\nimport { BrowserAnimationsModule } from '@angular/platform-browser/animations';\r\nimport { NgModule } from '@angular/core';\r\n\r\nimport { AppComponent } from './app.component';\r\nimport { CommonModule } from '@angular/common';\r\nimport { ReactiveFormsModule, FormsModule } from '@angular/forms';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport {\r\n  MatTabsModule,\r\n  MatIconModule,\r\n  MatButtonModule,\r\n  MatSlideToggleModule\r\n} from '@angular/material';\r\nimport { MatFirebaseUploadModule } from 'projects/mat-firebase-upload/src/public-api';\r\nimport { TestFormFilesComponent } from './test-form-files.component';\r\nimport { TestFormFileComponent } from './test-form-file.component';\r\nimport { TestFormImageComponent } from './test-form-image.component';\r\nimport { TestFormViewersComponent } from './test-form-viewers.component';\r\n\r\nconst entryComponents = [\r\n  TestFormFilesComponent,\r\n  TestFormFileComponent,\r\n  TestFormImageComponent,\r\n  TestFormViewersComponent\r\n];\r\n\r\nconst allRoutes: Routes = [\r\n  { path: 'form-firebase-file', component: TestFormFileComponent },\r\n  { path: 'form-firebase-files', component: TestFormFilesComponent },\r\n  { path: 'form-firebase-image', component: TestFormImageComponent },\r\n  { path: 'form-firebase-viewers', component: TestFormViewersComponent }\r\n];\r\n\r\n@NgModule({\r\n  declarations: [AppComponent, ...entryComponents],\r\n  entryComponents: [...entryComponents],\r\n  imports: [\r\n    BrowserModule,\r\n    BrowserAnimationsModule,\r\n    CommonModule,\r\n    ReactiveFormsModule,\r\n    FormsModule,\r\n    MatFirebaseUploadModule,\r\n    RouterModule.forRoot(allRoutes),\r\n\r\n    MatTabsModule,\r\n    MatButtonModule,\r\n    MatSlideToggleModule,\r\n    MatIconModule\r\n  ],\r\n  providers: [],\r\n  bootstrap: [AppComponent]\r\n})\r\nexport class AppModule {}\r\n","\r\nimport { environment } from '../environments/environment';\r\nimport { FormFileObject, FormFirebaseConfigurationBase } from 'projects/mat-firebase-upload/src/public-api';\r\n\r\nexport function blankFile(url: string): FormFileObject {\r\n  return {\r\n    id: url,\r\n    fileicon: '/assets/fileicons/image.svg',\r\n    imageurl: url,\r\n    bucket_path: '',\r\n    value: {\r\n      name:\r\n        'imageimageimageimageimageimageimageimageimageimageimageimageimage.jpeg',\r\n      props: {\r\n        thumb: '',\r\n        fileicon: '',\r\n        progress: 100,\r\n        completed: true\r\n      }\r\n    }\r\n  };\r\n}\r\n\r\nexport function blankFile2(): FormFileObject {\r\n  return blankFile('https://i.imgur.com/HSdYMMN.jpg');\r\n}\r\n\r\nexport async function makeConfig(ms?: number) {\r\n  if (ms) {\r\n    await delay(ms);\r\n  }\r\n  const config: FormFirebaseConfigurationBase = {\r\n    directory: `audits/somelocation`,\r\n    firebaseConfig: environment.firebaseConfig,\r\n    useUuidName: true,\r\n    acceptedFiles: 'application/pdf,image/*',\r\n    imageCompressionMaxSize: 1600,\r\n    imageCompressionQuality: 0.9\r\n  };\r\n  return config;\r\n}\r\n\r\nexport async function delay(ms: number) {\r\n  await new Promise(resolve => setTimeout(resolve, ms));\r\n}","import { Component, OnInit } from \"@angular/core\";\nimport { blankFile, makeConfig, delay } from \"./file-factory\";\nimport { FormControl } from \"@angular/forms\";\nimport { FormFirebaseFilesConfiguration } from \"mat-firebase-upload/public-api\";\n\n@Component({\n  template: `\n    <h2>File Uploader/Viewer Control</h2>\n    <div>\n      <h5>Control Enabled({{ enabledControl.value | json }})</h5>\n      <mat-slide-toggle [formControl]=\"enabledControl\"> </mat-slide-toggle>\n    </div>\n    <div class=\"container-2cols\">\n      <form-firebase-file\n        *ngIf=\"controlFile\"\n        [config]=\"config\"\n        [formControl]=\"controlFile\"\n        debug=\"true\"\n      >\n      </form-firebase-file>\n      <pre>{{ controlFile?.value | json }}</pre>\n    </div>\n  `\n})\nexport class TestFormFileComponent implements OnInit {\n  enabledControl = new FormControl(true);\n  controlFile = new FormControl(blankFile(\"https://i.imgur.com/uUL3zYD.jpg\"));\n  config: FormFirebaseFilesConfiguration;\n\n  constructor() {\n    this.enabledControl.valueChanges.subscribe(isEnabled => {\n      if (isEnabled) {\n        this.controlFile.enable();\n      } else {\n        this.controlFile.disable();\n      }\n    });\n  }\n\n  async ngOnInit() {\n    await delay(1000);\n    this.controlFile.setValue(blankFile(\"https://i.imgur.com/ioqsdHZ.jpeg\"))\n    this.config = await makeConfig(3000);\n  }\n}\n","import { Component, OnInit } from '@angular/core';\nimport { blankFile, makeConfig } from './file-factory';\nimport { FormControl } from '@angular/forms';\nimport { FormFirebaseFilesConfiguration } from 'projects/mat-firebase-upload/src/public-api';\nimport { delay } from 'rxjs/operators';\n\n@Component({\n  template: `\n    <h2>Files Uploader/Viewer Control</h2>\n    <div>\n      <h5>Control Enabled({{ enabledControl.value | json }})</h5>\n      <mat-slide-toggle [formControl]=\"enabledControl\"> </mat-slide-toggle>\n    </div>\n    <div class=\"container-2cols\">\n      <form-firebase-files\n        [formControl]=\"controlFiles\"\n        [config]=\"config\"\n        debug=\"true\"\n      >\n      </form-firebase-files>\n      <pre>{{ controlFiles?.value | json }}</pre>\n    </div>\n  `\n})\nexport class TestFormFilesComponent implements OnInit {\n  enabledControl = new FormControl(true);\n  controlFiles = new FormControl([\n    blankFile('https://i.imgur.com/uUL3zYD.jpg'),\n    blankFile('https://i.imgur.com/HSdYMMN.jpg')\n  ]);\n  config: FormFirebaseFilesConfiguration;\n\n  constructor() {\n    this.enabledControl.valueChanges.subscribe(isEnabled => {\n      if (isEnabled) {\n        this.controlFiles.enable();\n      } else {\n        this.controlFiles.disable();\n      }\n    });\n  }\n\n  async ngOnInit() {\n    await delay(1000);\n    this.config = await makeConfig(2000);\n  }\n}\n","import { Component, OnInit } from '@angular/core';\nimport { blankFile, makeConfig } from './file-factory';\nimport { FormControl } from '@angular/forms';\nimport { FormFirebaseFilesConfiguration } from 'mat-firebase-upload/public-api';\n\n@Component({\n  template: `\n    <h2>File Uploader/Viewer Control</h2>\n    <div>\n      <h5>Control Enabled({{ enabledControl.value | json }})</h5>\n      <mat-slide-toggle [formControl]=\"enabledControl\"> </mat-slide-toggle>\n    </div>\n    <h2>Image Uploader/Viewer Control</h2>\n    <div class=\"container-2cols\">\n      <form-firebase-image\n        [formControl]=\"controlImage\"\n        [config]=\"config\"\n        debug=\"true\"\n      >\n      </form-firebase-image>\n      <pre>{{ controlImage?.value | json }}</pre>\n    </div>\n    <h2>Image Uploader/Viewer Control2</h2>\n    <div class=\"container-2cols\">\n      <form-firebase-image\n        [formControl]=\"controlImage2\"\n        [config]=\"config\"\n        debug=\"true\"\n      >\n      </form-firebase-image>\n      <pre>{{ controlImage2?.value | json }}</pre>\n    </div>\n  `\n})\nexport class TestFormImageComponent implements OnInit {\n  enabledControl = new FormControl(true);\n  controlImage = new FormControl(blankFile('https://i.imgur.com/uUL3zYD.jpg'));\n  controlImage2 = new FormControl(blankFile('https://i.imgur.com/HSdYMMN.jpg'));\n  config: FormFirebaseFilesConfiguration;\n\n  constructor() {\n    this.enabledControl.valueChanges.subscribe(isEnabled => {\n      if (isEnabled) {\n        this.controlImage.enable();\n        this.controlImage2.enable();\n      } else {\n        this.controlImage.disable();\n        this.controlImage2.disable();\n      }\n    });\n  }\n\n  async ngOnInit() {\n    this.config = await makeConfig();\n  }\n}\n","import { Component, OnInit } from '@angular/core';\nimport { blankFile, makeConfig } from './file-factory';\nimport { FormControl } from '@angular/forms';\nimport { FormFirebaseFilesConfiguration } from 'mat-firebase-upload/public-api';\n\n@Component({\n  template: `\n    <h2>File Uploader/Viewer Control</h2>\n    <div>\n      <h5>Control Enabled({{ enabledControl.value | json }})</h5>\n      <mat-slide-toggle [formControl]=\"enabledControl\"> </mat-slide-toggle>\n    </div>\n    <h2>Files Viewer Only</h2>\n    <div class=\"container-2cols\">\n      <form-firebase-files-viewer [value]=\"controlFiles.value\">\n      </form-firebase-files-viewer>\n      <pre>{{ controlFiles?.value | json }}</pre>\n    </div>\n    <h2>Image With Loader</h2>\n    <div class=\"container-2cols\">\n      <img-with-loader [src]=\"imgUrl\"></img-with-loader>\n      <pre>{{ imgUrl | json }}</pre>\n    </div>\n    <h2>Image Gallery</h2>\n    <div class=\"container-2cols\">\n      <preview-gallery [imageUrls]=\"imgUrls\"> </preview-gallery>\n      <pre>{{ imgUrls | json }}</pre>\n    </div>\n\n  `\n})\nexport class TestFormViewersComponent implements OnInit {\n  enabledControl = new FormControl(true);\n  config: FormFirebaseFilesConfiguration;\n\n  controlFiles = new FormControl([\n    blankFile('https://i.imgur.com/uUL3zYD.jpg'),\n    blankFile('https://i.imgur.com/HSdYMMN.jpg')\n  ]);\n  imgUrl = 'https://i.imgur.com/uUL3zYD.jpg';\n  imgUrls = [\n    'https://i.imgur.com/uUL3zYD.jpg',\n    'https://i.imgur.com/HSdYMMN.jpg'\n  ];\n\n  constructor() {\n    this.enabledControl.valueChanges.subscribe(isEnabled => {\n      if (isEnabled) {\n        this.controlFiles.enable();\n      } else {\n        this.controlFiles.disable();\n      }\n    });\n  }\n\n  async ngOnInit() {\n    this.config = await makeConfig();\n  }\n}\n","// This file can be replaced during build by using the `fileReplacements` array.\n// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.\n// The list of file replacements can be found in `angular.json`.\n\nexport const environment = {\n  production: false,\n  firebaseConfig: {\n    apiKey: 'AIzaSyBaaNXOsruNPyDrQpKEnw-S-BnvwKlTfR4',\n    authDomain: 'comm-unstable.firebaseapp.com',\n    databaseURL: 'https://comm-unstable.firebaseio.com',\n    projectId: 'comm-unstable',\n    storageBucket: 'comm-unstable.appspot.com',\n    messagingSenderId: '1061697142615',\n    appId: '1:1061697142615:web:23f9c7b10d97acfe'\n  }\n};\n\n/*\n * For easier debugging in development mode, you can import the following file\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\n *\n * This import should be commented out in production mode because it will have a negative impact\n * on performance if an error is thrown.\n */\n// import 'zone.js/dist/zone-error';  // Included with Angular CLI.\n","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nimport 'hammerjs';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.error(err));\n"],"sourceRoot":""}